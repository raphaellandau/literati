jQuery(document).ready(function(){new GFOwnerSetting});var legacyUI=gform_hubspot_owner_settings_strings.legacy_ui,prefix={input:legacyUI?"_gaddon_setting_":"_gform_setting_",field:legacyUI?"gaddon-setting-row-":"gform_setting_"};function GFOwnerSetting(){var n=jQuery;this.init=function(){this.initOwner(),new GFConditionsSetting},this.initOwner=function(){var t=this;n("#contact_owner0, #contact_owner1, #contact_owner2").on("change",function(){t.toggleOwner(!0)}),this.toggleOwner(!1)},this.toggleOwner=function(t){var e=["#"+prefix.field+"contact_owner_select","#"+prefix.field+"contact_owner_conditional"],i=n(".contact_owner_section"),o=n('input[name="'+prefix.input+'contact_owner"]:checked').val();n(e.join(", ")).hide(),"none"!==o?(i.is(":hidden")&&(t&&legacyUI?i.slideDown():i.show()),n("#"+prefix.field+"contact_owner_"+o).show()):t&&legacyUI?i.slideUp():i.hide()},this.init()}function GFConditionsSetting(){var s=jQuery;this.$element=jQuery("#gform_conditions_setting"),this.fieldId="conditions",this.fieldName=prefix.input+"conditions",this.options=null,this.init=function(){var t,e,r=this;this.options={fieldName:this.fieldName,fieldId:this.fieldId,fields:gform_hubspot_owner_settings_strings.fields,owners:gform_hubspot_owner_settings_strings.owners,imagesURL:gf_vars.baseUrl+"/images",items:this.getItems(),operatorStrings:{is:"is",isnot:"isNot",">":"greaterThan","<":"lessThan",contains:"contains",starts_with:"startsWith",ends_with:"endsWith"}},e='<thead><tr><th class="gform-routings__heading gform-routings__heading--assign">{0}</th>',e+='<th class="gform-routings__heading gform-routings__heading--condition" colspan="3">{1}</th>',e=(e+="</tr></thead>").format(gform_hubspot_owner_settings_strings.assign_to,gform_hubspot_owner_settings_strings.condition),t='<table class="gform-routings">{0}<tbody class="repeater">{1}</tbody></table>'.format(e,this.getNewRow());var i=s(t);i.find(".repeater").repeater({limit:0,items:this.options.items,addButtonMarkup:'<i class="gficon-add"></i>',removeButtonMarkup:'<i class="gficon-subtract"></i>',callbacks:{save:function(t,e){s("#"+r.options.fieldId).val(s.toJSON(e))},beforeAdd:function(t,e,i){i.owner&&e.find(".gform-routing-owners").val(i.owner);var o=e.find(".gform-routing-field").first();o.value=i.fieldId,r.changeField(o);var n=e.find(".gform-routing-operator").first();n.value=i.operator,r.changeOperator(n),e.find(".gform-routing-value").val(i.value)}}}).on("change",".gform-routing-field",function(t){r.changeField(this)}).on("change",".gform-routing-operator",function(){r.changeOperator(this)}),this.$element.append(i)},this.getNewRow=function(){var t=[];return t.push("<td>{0}</td>".format(this.getOwners())),t.push("<td>{0}</td>".format(this.getFields())),t.push("<td>{0}</td>".format(this.getOperators(this.options.fields[0]))),t.push("<td>{0}</td>".format(this.getValues())),t.push('<td class="gform-routings-field gform-routings-field__buttons">{buttons}</td>'),'<tr class="gform-routing-row">{0}</tr>'.format(t.join(""))},this.getOwners=function(){var t,e=this.options.owners,i='<select class="gform-routing-owners owner_{i}">';for(t=0;t<e.length;t++)i+='<option value="{0}">{1}</option>'.format(e[t].value,e[t].label);return i+="</select>"},this.getFields=function(){var t,e,i,o,n,r,s,a,l=[],f=this.options.fields;for(l.push('<select class="gform-routing-field fieldId_{i}" >'),t=0;t<f.length;t++)if(i=f[t].key,f[t].group){for(r=f[t].text,a=f[t].filters.length,s=[],e=0;e<a;e++)n=f[t].filters[e].text,o=f[t].filters[e].key,s.push('<option value="{0}">{1}</option>'.format(o,n));l.push('<optgroup label="{0}">{1}</optgroup>'.format(r,s.join("")))}else n=f[t].text,l.push('<option value="{0}">{1}</option>'.format(i,n));return l.push("</select>"),l.join("")},this.changeOperator=function(t){var e=s(t),i=e.closest("tr").find(".repeater-buttons").find(".add-item ").data("index"),o=e.closest("tr").find(".gform-routing-field"),n=this.getFilter(o.value);n&&e.closest("tr").find(".gform-routing-value").replaceWith(this.getValues(n,t.value,i))},this.changeField=function(t){var e=this.getFilter(t.value);if(e){var i=s(t),o=i.closest("tr").find(".repeater-buttons").find(".add-item ").data("index");i.closest("tr").find(".gform-routing-value").replaceWith(this.getValues(e,null,o)),i.closest("tr").find(".gform-filter-type").val(e.type).change();var n=s(this.getOperators(e,o));i.closest("tr").find(".gform-routing-operator").replaceWith(n),i.closest("tr").find(".gform-routing-operator").change()}},this.getOperators=function(t,e){null==e&&(e="{i}");var i,o,n=this.options.operatorStrings,r='<select class="gform-routing-operator operator_{0}">'.format(e);if(t)for(i=0;i<t.operators.length;i++)o=t.operators[i],r+='<option value="{0}">{1}</option>'.format(o,gf_vars[n[o]]);return r+="</select>"},this.getValues=function(t,e,i){var o,n,r,s,a="";if(null==i&&(i="{i}"),t&&t.values&&"contains"!=e){for(o=0;o<t.values.length;o++)n=t.values[o].value,r=t.values[o].text,a+='<option value="{0}">{1}</option>'.format(n,r);s='<select class="gform-routing-value value_{0}">{1}</select>'.format(i,a)}else s='<input type="text" value="" class="gform-routing-value value_{0}" />'.format(i);return s},this.getFilter=function(t){var e=this.options.fields;if(t)for(var i=0;i<e.length;i++){if(t==e[i].key)return e[i];if(e[i].group)for(var o=0;o<e[i].filters.length;o++)if(t==e[i].filters[o].key)return e[i].filters[o]}},this.selected=function(t,e){return t==e?'selected="selected"':""},this.getItems=function(){var t=s("#"+this.fieldId).val();return t?s.parseJSON(t):[{owner:"",fieldId:"0",operator:"is",value:""}]},this.init(),String.prototype.format=function(){var i=arguments;return this.replace(/{(\d+)}/g,function(t,e){return void 0!==i[e]?i[e]:t})}}